<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>찰스의 AI 스튜디오</title>
  <meta name="theme-color" content="#ef4444" />
  <link rel="icon" href="favicon.ico" />
  <meta name="color-scheme" content="dark" />

  <!-- GitHub Pages 프로젝트 경로 고정 -->
  <base href="https://charlesaistudio.github.io/AI-studio/">

  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <!-- NAV -->
  <nav class="nav">
    <div class="nav-inner">
      <div class="logo">찰스의 AI 스튜디오</div>

      <!-- 상단 가로 메뉴 -->
      <ul class="nav-links" aria-label="주요 메뉴">
        <li><a href="#flow">워크플로</a></li>
        <li><a href="#faq">FAQ</a></li>
      </ul>

      <div class="right-actions">
        <!-- 유저 칩 (로그인 시에만 표시) -->
        <div id="userChip" class="user-chip" aria-live="polite">
          <img id="userAvatar" alt="" />
          <span id="userName">사용자</span>
        </div>

        <!-- 로그인/로그아웃 버튼 -->
        <button id="loginBtn" class="btn-sm primary" type="button">로그인</button>
        <button id="logoutBtn" class="btn-sm hidden" type="button">로그아웃</button>

        <!-- 햄버거: 우측 사이드 패널 토글 -->
        <button
          id="toolsBtn"
          class="hamb"
          aria-label="툴 메뉴 열기/닫기"
          aria-expanded="false"
          aria-controls="toolsDrawer">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2" stroke-linecap="round">
            <path d="M3 6h18M3 12h18M3 18h18"/>
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- 우측 슬라이드 패널 (툴 링크) -->
  <div id="toolsBackdrop" class="tools-backdrop" aria-hidden="true"></div>
  <aside id="toolsDrawer" class="tools-drawer" role="dialog" aria-modal="true" aria-label="빠른 툴 링크">
    <header class="tools-header">
      <h3>AI툴</h3>
      <button class="tools-close" aria-label="닫기" onclick="closeTools()">✕</button>
    </header>

    <nav class="tools-body">
      <a class="tool-item" href="https://chat.openai.com" target="_blank" rel="noopener" onclick="closeTools()">
        <span class="tool-name">🤖 ChatGPT</span>
        <span class="tool-desc">대본/아이디어 생성</span>
      </a>

      <a class="tool-item" href="https://www.midjourney.com/" target="_blank" rel="noopener" onclick="closeTools()">
        <span class="tool-name">🎨 Midjourney</span>
        <span class="tool-desc">이미지 생성</span>
      </a>

      <a class="tool-item" href="https://suno.com" target="_blank" rel="noopener" onclick="closeTools()">
        <span class="tool-name">🎵 Suno</span>
        <span class="tool-desc">음악 생성</span>
      </a>

      <a class="tool-item" href="https://labs.google/fx/tools/videofx" target="_blank" rel="noopener" onclick="closeTools()">
        <span class="tool-name">🎬 Veo 3</span>
        <span class="tool-desc">영상 생성 (Google VideoFX)</span>
      </a>

      <a class="tool-item" href="https://klingai.com/" target="_blank" rel="noopener" onclick="closeTools()">
        <span class="tool-name">🚀 Kling</span>
        <span class="tool-desc">고품질 비디오 생성</span>
      </a>
    </nav>
  </aside>

  <!-- 로그인 모달 (기본 숨김) -->
  <div id="authModal" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="authTitle" style="display:none">
    <div class="modal">
      <button class="close" aria-label="닫기" onclick="toggleAuth(false)">✕</button>
      <h3 id="authTitle">로그인</h3>
      <p>Google 계정으로 안전하게 로그인합니다.</p>
      <div class="actions">
        <button id="googleSignIn" class="btn-sm primary" type="button">Google로 로그인</button>
        <span id="authError" class="login-error hidden"></span>
      </div>
    </div>
  </div>

  <!-- HERO -->
 <header class="hero">
  <div class="wrap hero-grid">
    <!-- 왼쪽: 텍스트 -->
    <div class="hero-text">
      <h1>유튜브에서 통하는 <span style="color:var(--brand)">AI 영상 제작</span> A→Z</h1>
      <p class="lead">
        아이디어 → 대본 → 음악/이미지 → 애니메이션 → 편집/자막 → 업로드까지.<br>
        실제 업로드 가능한 완성본을 목표로, 필요한 툴과 템플릿을 한 번에 잡아줍니다.
      </p>
    </div>

    <!-- 오른쪽: 대표님 사진 -->
    <div class="hero-photo">
      <img src="assets/ceo1.png" alt="대표님" />
    </div>
  </div>
</header>


  <!-- MAIN -->
  <main class="wrap">
    <section id="flow" class="wf-carousel">
      <div class="wf-head">
        <h2>핵심 워크플로</h2>
        <div class="wf-controls">
          <button class="wf-prev" aria-label="이전 워크플로">‹</button>
          <button class="wf-next" aria-label="다음 워크플로">›</button>
        </div>
      </div>
      <p class="sub">실전 예제로 배우는 프로젝트</p>

      <div class="wf-viewport" tabindex="0" aria-label="워크플로 슬라이더">
        <div class="wf-track">
          <!-- 카드 1: 전체가 링크 (로그인 필요) -->
          <a href="workflow-1.html"
             class="wf-card card is-link"
             data-requires-auth
             style="text-decoration:none; color:inherit">
            <div class="wf-pill">Workflow 1</div>
            <h3>캐릭터 제어 영상 만들기</h3>
            <p class="sub">AI로 만든 캐릭터를 움직이고, 말하고, 표정까지 제어하는 법.</p>
            <div class="video">
              <iframe
                src="https://www.youtube.com/embed/sYYQxGDWxZ0"
                title="캐릭터 제어 예시"
                allowfullscreen
                loading="lazy"
              ></iframe>
            </div>
          </a>

          <article class="wf-card card">
            <div class="wf-pill">Workflow 2</div>
            <h3>뮤직비디오 만들기</h3>
            <p class="sub">Suno 음악에 맞춰 이미지/클립을 이어서 뮤비 제작.</p>
            <div class="video">
              <iframe
                src="https://www.youtube.com/embed/CQedWk7ijj4"
                title="뮤직비디오 예시"
                allowfullscreen
                loading="lazy"
              ></iframe>
            </div>
          </article>

          <article class="wf-card card">
            <div class="wf-pill">Workflow 3</div>
            <h3>지브리풍 영상 만들기</h3>
            <p class="sub">Midjourney + Runway/Veo로 지브리 감성 애니메이션.</p>
            <div class="video">
              <iframe
                src="https://www.youtube.com/embed/ScMzIvxBSi4"
                title="지브리풍 예시"
                allowfullscreen
                loading="lazy"
              ></iframe>
            </div>
          </article>
        </div>

        <!-- 양옆 그라디언트 -->
        <div class="wf-fade wf-fade-left" aria-hidden="true"></div>
        <div class="wf-fade wf-fade-right" aria-hidden="true"></div>
      </div>
    </section>

    <section id="check">
      <h2>준비물 체크리스트</h2>
      <p class="sub">수업 시작 전에 계정과 파일만 준비하면 바로 제작 가능</p>
      <div class="grid g-3">
        <div class="card">
          <h3>필수 계정</h3>
          <ul>
            <li>Google 계정 + YouTube 채널</li>
            <li>Suno / Midjourney / Runway(Veo) 중 2개 이상</li>
            <li>CapCut(PC) 설치</li>
          </ul>
        </div>
        <div class="card">
          <h3>템플릿 패키지</h3>
          <ul>
            <li>스크립트 템플릿(.txt/.md)</li>
            <li>CapCut 프리셋(.cptemplate)</li>
            <li>썸네일 PSD/PNG 프레임</li>
          </ul>
        </div>
        <div class="card">
          <h3>권장 사양</h3>
          <ul>
            <li>메모리 16GB 이상</li>
            <li>저장공간 10GB 여유</li>
            <li>안정된 업로드 네트워크</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="faq">
      <h2>FAQ</h2>
      <details>
        <summary>완전 초보도 가능한가요?</summary>
        <p>가능. 툴 설치/가입부터 시작해서, 템플릿에 값만 채워도 결과물이 나오도록 구성했어.</p>
      </details>
      <details>
        <summary>저작권/라이선스는 어떻게 다루나요?</summary>
        <p>각 툴의 이용 약관과 유튜브 가이드라인을 함께 점검하고, 상업적 사용시 주의할 포인트를 체크리스트로 제공해.</p>
      </details>
      <details>
        <summary>Shorts와 16:9 중 뭘 먼저 만들까요?</summary>
        <p>리텐션 학습엔 Shorts가 빠르고, 브랜드 서사는 16:9가 유리. 수업에선 두 포맷을 병행해 템플릿을 나눠 제공해.</p>
      </details>
    </section>
  </main>

  <footer class="wrap" style="padding:24px 0; color:var(--muted); border-top:1px solid var(--line);">
    © 2025 찰스의 AI 스튜디오 · YouTube AI Video Course
  </footer>

  <!-- 스크립트 -->
  <script type="module" src="assets/slider.js"></script>
  <!-- 주의: 중복 초기화 방지 위해 assets/app.js는 로드하지 않음 -->

  <!-- 우측 패널 토글/닫기 -->
  <script>
    function toggleTools() {
      const btn = document.querySelector('.hamb');
      const wasOpen = document.body.classList.toggle('tools-open');
      btn.setAttribute('aria-expanded', String(wasOpen));
      if (wasOpen) {
        document.getElementById('toolsDrawer')
          .querySelector('a.tool-item')?.focus();
      } else {
        btn.focus();
      }
    }
    function closeTools() {
      const btn = document.querySelector('.hamb');
      document.body.classList.remove('tools-open');
      btn.setAttribute('aria-expanded', 'false');
    }
    document.getElementById('toolsBackdrop').addEventListener('click', closeTools);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeTools(); });
    (function () {
      const btn = document.getElementById('toolsBtn');
      const drawer = document.getElementById('toolsDrawer');
      const backdrop = document.getElementById('toolsBackdrop');
      if (!btn || !drawer || !backdrop) return;
      function openTools() {
        document.body.classList.add('tools-open');
        btn.setAttribute('aria-expanded', 'true');
        setTimeout(() => drawer.querySelector('a.tool-item')?.focus(), 0);
      }
      function closeTools() {
        document.body.classList.remove('tools-open');
        btn.setAttribute('aria-expanded', 'false');
        btn.focus();
      }
      function toggleTools() {
        if (document.body.classList.contains('tools-open')) closeTools();
        else openTools();
      }
      btn.addEventListener('click', toggleTools);
      backdrop.addEventListener('click', closeTools);
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeTools(); });
      document.addEventListener('click', (e) => {
        if (!document.body.classList.contains('tools-open')) return;
        if (drawer.contains(e.target) || btn.contains(e.target)) return;
        closeTools();
      });
      window.toggleTools = toggleTools;
      window.closeTools = closeTools;
    })();
  </script>

  <!-- Firebase + Auth Gate (단일 모듈 스크립트) -->
  <script type="module">
    import { initializeApp, getApps, getApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getAuth, GoogleAuthProvider,
      signInWithPopup, signInWithRedirect, getRedirectResult,
      signOut, onAuthStateChanged,
      setPersistence, browserLocalPersistence
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const $ = (id) => document.getElementById(id);
    const toggleAuth = (open) => {
      const modal = $("authModal");
      if (!modal) return;
      modal.style.display = open ? "flex" : "none";
      if (open) document.body.classList.remove("menu-open");
    };
    window.toggleAuth = toggleAuth;

    const url = (p) => { try { new URL(p); return p; } catch { return new URL(p, document.baseURI).toString(); } };

    const firebaseConfig = {
      apiKey: "AIzaSyD_IuakhMe5Qofl85JDdAJ1IUu1eaN5paU",
      authDomain: "charles01-9eee3.firebaseapp.com",
      projectId: "charles01-9eee3",
      messagingSenderId: "409220278869",
      appId: "1:409220278869:web:ebbab45579e96c22a482dc",
    };

    // 중복 초기화 방지
    const app  = getApps().length ? getApp() : initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    document.addEventListener("DOMContentLoaded", async () => {
      // UI refs
      const loginBtn   = $("loginBtn");
      const logoutBtn  = $("logoutBtn");
      const userChip   = $("userChip");
      const userName   = $("userName");
      const userAvatar = $("userAvatar");
      const googleBtn  = $("googleSignIn");

      try { await setPersistence(auth, browserLocalPersistence); } catch(e){ console.warn("persistence:", e?.code||e); }
      try { await getRedirectResult(auth); } catch(e){ console.warn("redirectResult:", e?.code||e); }

      async function doGoogleLogin() {
        try {
          await signInWithPopup(auth, provider);
        } catch (err) {
          const code = err?.code || "";
          if (code.includes("popup") || code === "auth/popup-blocked" || code === "auth/cancelled-popup-request") {
            await signInWithRedirect(auth, provider);
          } else {
            alert("로그인 실패: " + (code || err?.message || err));
            console.error(err);
          }
        }
      }

      // 버튼 바인딩
      loginBtn?.addEventListener("click", doGoogleLogin);
      googleBtn?.addEventListener("click", doGoogleLogin);
      logoutBtn?.addEventListener("click", async () => { try { await signOut(auth); } catch(e){ console.error(e); } });

      function showLoggedInUI(user){
        if (userName) userName.textContent = user?.displayName || user?.email || "사용자";
        if (userAvatar){ userAvatar.src = user?.photoURL || ""; userAvatar.alt = user?.displayName || user?.email || "사용자"; }
        userChip?.classList.remove("hidden");
        userChip && (userChip.style.display = "inline-flex");
        loginBtn?.classList.add("hidden");
        logoutBtn?.classList.remove("hidden");
      }
      function showLoggedOutUI(){
        userChip?.classList.add("hidden");
        userChip && (userChip.style.display = "none");
        loginBtn?.classList.remove("hidden");
        logoutBtn?.classList.add("hidden");
      }

      function tryPostLoginRedirect(){
        const key = "postLoginRedirect";
        const next = localStorage.getItem(key);
        if (next) {
          localStorage.removeItem(key);
          location.href = url(next);
        }
      }

      // 링크 잠금/해제 (비로그인 시 절대 이동 금지)
      function lockProtectedLinks() {
        document.querySelectorAll('[data-requires-auth]').forEach(el => {
          const href = el.getAttribute('href');
          if (href && !el.dataset.authHref) el.dataset.authHref = href;
          el.setAttribute('href', 'javascript:void(0)');
          el.setAttribute('aria-disabled', 'true');
          el.setAttribute('title', '로그인 후 이용 가능');
          el.style.cursor = 'not-allowed';
        });
      }
      function unlockProtectedLinks() {
        document.querySelectorAll('[data-requires-auth]').forEach(el => {
          if (el.dataset.authHref) el.setAttribute('href', el.dataset.authHref);
          el.removeAttribute('aria-disabled');
          el.removeAttribute('title');
          el.style.removeProperty('cursor');
        });
      }

      onAuthStateChanged(auth, (user) => {
        window.currentUser = user || null;
        if (user) {
          unlockProtectedLinks();
          showLoggedInUI(user);
          toggleAuth(false);
          tryPostLoginRedirect();
        } else {
          lockProtectedLinks();
          showLoggedOutUI();
        }
      });

      // AUTH GATE (캡처링: 가장 먼저 가로채기)
      document.addEventListener("click", (e) => {
        const el = e.target.closest("[data-requires-auth]");
        if (!el) return;
        if (window.currentUser) return;
        e.preventDefault();
        e.stopPropagation();
        const next = el.dataset.authHref || el.getAttribute("href") || "/";
        try { localStorage.setItem("postLoginRedirect", next); } catch {}
        toggleAuth(true);
      }, true);
    });
  </script>
</body>
</html>
